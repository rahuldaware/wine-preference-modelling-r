---
title: Exploratory Data Analysis on Red Wine Dataset to find which parameters affect
  the red wine quality
author: "Rahul Daware (rahuldaware19@gmail.com)"
output:
  html_document:
    fig_width : 12
    fig_height : 10
  pdf_document: default
---

### Step 1: Import Red Wine Dataset  
Let us read the CSV file into R and explain all 11 properties. These properties are explained below:  


1. **fixed.acidity**: most acids involved with wine or fixed or nonvolatile (do not evaporate readily)  
2. **volatile.acidity**: the amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste  
3. **citric.acid**: found in small quantities, citric acid can add 'freshness' and flavor to wines  
4. **residual.sugar**: the amount of sugar remaining after fermentation stops, it's rare to find wines with less than 1 gram/liter and wines with greater than 45 grams/liter are considered sweet  
5. **chlorides**: the amount of salt in the wine  
6. **free.sulfur.dioxide**: the free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents microbial growth and the oxidation of wine  
7. **total.sulfur.dioxide**: amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine  
8. **density**: the density of water is close to that of water depending on the percent alcohol and sugar content  
9. **pH**: describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic); most wines are between 3-4 on the pH scale  
10. **sulphates**: a wine additive which can contribute to sulfur dioxide gas (S02) levels, wich acts as an antimicrobial and antioxidant  
11. **alcohol**: the percent alcohol content of the wine  
12. **quality** : score between 0 and 10. 10 being the best  

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.
require(ggplot2)
require(cowplot)
```

Let us look at the structure of dataset:

```{r echo=FALSE}
wineData = read.csv("wineQualityReds.csv")
str(wineData)
```

Next, let us look at data set summary:
```{r echo=FALSE}
summary(wineData)
```

### Step 2: Univariate Analysis  


The histogram of Red Wine Quality is drawn below : 
```{r echo=FALSE, warning=FALSE}
ggplot(data = wineData, aes(x = wineData$quality)) + 
  scale_x_continuous("Wine Quality") + 
  scale_y_continuous("Count") +
  ggtitle("Histogram of Red Wine Quality") +
  geom_histogram(binwidth = 0.25, fill = "blue", color = "black") 
```
From the above graph, we can see that the quality of red wine peaks at 5 and drops down on extreme ends. This almost follows normal distribution.   


Now let us look at some other variables before moving into advanced plots, let us plot histogram of acidities

```{r echo=FALSE, warning=FALSE}
p1 = ggplot(data = wineData, aes(x=wineData$fixed.acidity)) +  
    scale_x_continuous("Fixed Acidity") + 
    scale_y_continuous("Count") +
    ggtitle("Histogram of Fixed Acidity") +
    geom_histogram(binwidth=0.25, fill = "blue", color = "black") 
  
p2 = ggplot(data = wineData, aes(x=wineData$volatile.acidity)) +
     scale_x_continuous("Volatile Acidity") + 
     scale_y_continuous("Count") +
     ggtitle("Histogram of Volatile Acidity") +
  geom_histogram(binwidth=0.25, fill = "blue", color= "black")

plot_grid(p1, p2)
```

The fixed acidity falls in the range of 6 to 10.

The histogram of pH level is shown below:


```{r echo=FALSE, warning=FALSE}
ggplot(data = wineData, aes(x = wineData$pH)) + 
  scale_x_continuous("pH") + 
  scale_y_continuous("Count") +
  ggtitle("Histogram of Red Wine pH Level") +
  geom_histogram(binwidth = 0.25, fill = "blue", color = "black") 
```

From the above plot, pH value falls in 3.0 to 3.5 range.
The histogram of Citric Acid is shown below:  


```{r echo=FALSE, warning=FALSE}
ggplot(data = wineData, aes(x = wineData$citric.acid)) + 
  scale_x_continuous("Citric Acid") + 
  scale_y_continuous("Count") +
  ggtitle("Histogram of Red Wine Citric Acid") +
  geom_histogram(binwidth = 0.25, fill = "blue", color = "black") 
```


The citric acid content falls in the range of 0 to 0.6.  

### Step 3 : Bivariate Analysis

Lets draw correlation matrix of each variable with other.
```{r echo=FALSE, warning=FALSE}
library(GGally)
theme_set(theme_minimal(20))
set.seed(2222)
wine_subset <- wineData[,c(2:12)]
names(wine_subset)
ggpairs(wine_subset)
```


To find out which parameter affects the quality, let us correlate quality with all other parameters
```{r echo=FALSE}
cor(wineData[,2:12], wineData$quality)
```

From this, we can see that the quality of wine has less or negative correlation with acidity, no correlation with sugar and positive correlation with alcohol.  

### Step 4 : Multivariate Analysis

Let us find the effect of alcohol and citric acid on quality of red wine.  

```{r echo=FALSE, warning=FALSE}
ggplot(data= wineData, aes(x = wineData$alcohol, y = wineData$citric.acid, color = quality)) +
  scale_x_continuous("Citric Acid") +
  scale_y_continuous("Alcohol") +
  ggtitle("Relationship between Quality, Alcohol and Citric Acid") +
  geom_point()
```

From the above plot, we can see that the quality is higher when both alcohol and citric acid content is higher.

Let us plot a few more plots and find out which parameters affect the quality.  

```{r set-options, echo=FALSE, cache=FALSE}
options(width = 500)
ggplot(data= wineData, aes(x = wineData$alcohol, y = wineData$sulphates, color = quality)) +
  scale_x_continuous("Sulphates") +
  scale_y_continuous("Alcohol") +
  ggtitle("Relationship between Quality, Alcohol and Sulphates") +
  geom_point()
```

Here we see that the quality increases with sulphates. But alcohol has less effect on quality with sulphates.  

### Step 5: Final Plots


### Step 6: Reflection



